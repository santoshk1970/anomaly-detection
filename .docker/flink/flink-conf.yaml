# Flink Configuration
jobmanager.rpc.address: flink-jobmanager
jobmanager.rpc.port: 6123
jobmanager.memory.process.size: 1600m

taskmanager.memory.process.size: 1728m
taskmanager.numberOfTaskSlots: 4

parallelism.default: 2

# Checkpointing configuration (SR-004: Every 10s or 10k events)
# execution.checkpointing.interval: 10s
# execution.checkpointing.mode: EXACTLY_ONCE
# execution.checkpointing.timeout: 60s
# execution.checkpointing.max-concurrent-checkpoints: 1
# execution.checkpointing.min-pause: 5s

# State backend
state.backend: rocksdb
state.checkpoints.dir: file:///tmp/flink-checkpoints
state.savepoints.dir: file:///tmp/flink-savepoints

# Restart strategy
restart-strategy: fixed-delay
restart-strategy.fixed-delay.attempts: 3
restart-strategy.fixed-delay.delay: 10s

# Metrics

# JVM options
env.java.opts: "--add-opens=java.base/java.util=ALL-UNNAMED --add-opens=java.base/java.lang=ALL-UNNAMED --add-opens=java.base/java.lang.reflect=ALL-UNNAMED"

# S3/MinIO configuration for archival
s3.endpoint: http://minio:9000
s3.path.style.access: true
s3.access-key: minioadmin
s3.secret-key: minioadmin
fs.s3a.endpoint: http://minio:9000
fs.s3a.path.style.access: true
fs.s3a.access.key: minioadmin
fs.s3a.secret.key: minioadmin
fs.s3a.connection.ssl.enabled: false
fs.s3a.impl: org.apache.hadoop.fs.s3a.S3AFileSystem
fs.s3a.aws.credentials.provider: org.apache.hadoop.fs.s3a.SimpleAWSCredentialsProvider
fs.s3a.attempts.maximum: 3
fs.s3a.connection.establish.timeout: 5000
fs.s3a.connection.maximum.idle: 10000
fs.s3a.endpoint.region: us-east-1
blob.server.port: 6124
query.server.port: 6125

# Additional Prometheus configuration

# Prometheus metrics reporter with factory class (Flink 1.18+)

# Simple JMX metrics configuration
metrics.reporter.jmx.factory.class: org.apache.flink.metrics.jmx.JMXReporterFactory
metrics.reporter.jmx.port: 9999
